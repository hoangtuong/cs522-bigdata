#!/bin/bash

hadoop fs -rm -r /user/cloudera/project2/input
hadoop fs -mkdir /user/cloudera/project2
hadoop fs -put input /user/cloudera/project2/

# Store the start time
start=$(date +%s.%N)

spark-submit --class bigdata.loganalyzer.Main project2.jar

# Calculate and print out the execution duration
duration=$(echo "$(date +%s.%N) - $start" | bc)
printf "Execution time: %.6f seconds" $duration

#rm -rf output/spark/
#mkdir output output/spark
#hadoop fs -cat /user/cloudera/project2/output/* > result.txt
